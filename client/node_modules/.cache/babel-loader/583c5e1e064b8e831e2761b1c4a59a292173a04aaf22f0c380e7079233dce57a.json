{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,Link}from'react-router-dom';import{orderAPI}from'../services/api';import{toast,ToastContainer}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import'./OrderDetails.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OrderDetails=()=>{const{id}=useParams();const[order,setOrder]=useState(null);const[loading,setLoading]=useState(true);const[deliveryPersonnel,setDeliveryPersonnel]=useState(null);useEffect(()=>{loadOrder();// Refresh order data every 10 seconds for real-time updates\nconst interval=setInterval(()=>{loadOrder();},10000);return()=>clearInterval(interval);},[id]);const loadOrder=async()=>{try{const response=await orderAPI.getById(id);const orderData=response.data;setOrder(orderData);// Load delivery personnel info if assigned\nif(orderData.deliveryPersonnel){// In a real app, you'd have a separate API for delivery personnel\n// For demo, we'll simulate this data\nsetDeliveryPersonnel({name:'Loading...',phone:'+91 9999999999',vehicleType:'Bike',rating:4.8});}}catch(error){console.error('Error loading order:',error);}finally{setLoading(false);}};const getStatusColor=status=>{switch(status){case'Pending':return'#ffc107';case'Payment Processing':return'#17a2b8';case'Paid':return'#007bff';case'Preparing':return'#fd7e14';case'Out for Delivery':return'#6f42c1';case'Delivered':return'#28a745';case'Cancelled':return'#dc3545';default:return'#6c757d';}};const getTrackingIcon=status=>{switch(status){case'Payment Confirmed':return'üí≥';case'Preparing':return'üë®‚Äçüç≥';case'Delivery Assigned':return'üöó';case'On the way':return'üõ£Ô∏è';case'Nearby':return'üìç';case'Delivered':return'‚úÖ';default:return'üì¶';}};const formatTime=dateString=>{const date=new Date(dateString);return date.toLocaleTimeString('en-IN',{hour:'2-digit',minute:'2-digit',hour12:true});};const formatDate=dateString=>{const date=new Date(dateString);return date.toLocaleDateString('en-IN',{day:'numeric',month:'short',year:'numeric'});};const getTimeRemaining=()=>{if(!(order!==null&&order!==void 0&&order.estimatedDeliveryTime))return null;const now=new Date();const deliveryTime=new Date(order.estimatedDeliveryTime);const diff=deliveryTime-now;if(diff<=0)return'Delivered';const minutes=Math.floor(diff/(1000*60));const seconds=Math.floor(diff%(1000*60)/1000);return\"\".concat(minutes,\"m \").concat(seconds,\"s\");};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading order details...\"});}if(!order){return/*#__PURE__*/_jsx(\"div\",{className:\"order-details-page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Order not found\"}),/*#__PURE__*/_jsx(Link,{to:\"/orders\",className:\"btn btn-primary\",children:\"Back to Orders\"})]})})});}const timeRemaining=getTimeRemaining();return/*#__PURE__*/_jsxs(\"div\",{className:\"order-details-page\",children:[/*#__PURE__*/_jsx(ToastContainer,{position:\"top-right\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"order-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"order-title\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Order #\",order._id.slice(-8).toUpperCase()]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Placed on \",formatDate(order.createdAt),\" at \",formatTime(order.createdAt)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-status\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"status-badge\",style:{backgroundColor:getStatusColor(order.status)},children:order.status}),timeRemaining&&timeRemaining!=='Delivered'&&/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-timer\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"timer-label\",children:\"ETA:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"timer-value\",children:timeRemaining})]})]})]}),order.deliveryTracking&&order.deliveryTracking.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"card tracking-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCF1 Live Order Tracking\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsx(\"div\",{className:\"tracking-timeline\",children:order.deliveryTracking.map((track,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"tracking-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"tracking-icon\",children:getTrackingIcon(track.status)}),/*#__PURE__*/_jsxs(\"div\",{className:\"tracking-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"tracking-status\",children:track.status}),/*#__PURE__*/_jsx(\"div\",{className:\"tracking-message\",children:track.message}),/*#__PURE__*/_jsx(\"div\",{className:\"tracking-time\",children:formatTime(track.timestamp)})]})]},index))})})]}),order.deliveryPersonName&&/*#__PURE__*/_jsxs(\"div\",{className:\"card delivery-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDE97 Your Delivery Partner\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"delivery-avatar\",children:/*#__PURE__*/_jsx(\"span\",{className:\"avatar-icon\",children:\"\\uD83D\\uDC68\\u200D\\uD83D\\uDCBC\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-details\",children:[/*#__PURE__*/_jsx(\"h4\",{children:order.deliveryPersonName}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83D\\uDCF1 \",order.deliveryPersonPhone]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83D\\uDE97 \",order.deliveryPersonVehicle,\" Delivery\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-rating\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u2B50 \",order.deliveryPersonRating]}),/*#__PURE__*/_jsx(\"span\",{children:\"(150+ deliveries)\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"delivery-note\",children:/*#__PURE__*/_jsx(\"small\",{children:\"\\uD83D\\uDCCD Your delivery partner is assigned and will reach you within the estimated time\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-outline-primary\",children:\"\\uD83D\\uDCDE Call\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-outline-success\",children:\"\\uD83D\\uDCAC Chat\"})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"order-main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCE6 Order Items\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsx(\"div\",{className:\"order-items\",children:order.orderItems.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"order-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:item.name}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Quantity: \",item.quantity]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Price: \\u20B9\",item.price]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-total\",children:[\"\\u20B9\",(item.price*item.quantity).toFixed(2)]})]},index))})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83C\\uDFE0 Delivery Address\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"address\",children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"strong\",{children:order.shippingAddress.fullName})}),/*#__PURE__*/_jsx(\"p\",{children:order.shippingAddress.address}),/*#__PURE__*/_jsxs(\"p\",{children:[order.shippingAddress.city,\", \",order.shippingAddress.postalCode]}),/*#__PURE__*/_jsx(\"p\",{children:order.shippingAddress.country})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCB3 Payment Information\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Method:\"}),\" \",order.paymentMethod]}),/*#__PURE__*/_jsxs(\"div\",{className:\"payment-status\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"payment-badge \".concat(order.isPaid?'paid':'unpaid'),children:order.isPaid?'‚úÖ Paid':'‚è≥ Not Paid'}),order.isPaid&&order.paidAt&&/*#__PURE__*/_jsxs(\"span\",{className:\"payment-date\",children:[\"on \",formatDate(order.paidAt),\" at \",formatTime(order.paidAt)]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-sidebar\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCB0 Order Summary\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Items:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",order.itemsPrice.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Delivery:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",order.shippingPrice.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Tax (10%):\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",order.taxPrice.toFixed(2)]})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row total\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total Paid:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",order.totalPrice.toFixed(2)]})]})]})]}),order.status==='Delivered'&&/*#__PURE__*/_jsx(\"div\",{className:\"card success-card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"success-icon\",children:\"\\uD83C\\uDF89\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Order Delivered!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Thank you for choosing E-Shop!\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Delivered on \",formatDate(order.deliveredAt)]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-actions\",children:[/*#__PURE__*/_jsx(Link,{to:\"/orders\",className:\"btn btn-secondary\",children:\"\\u2190 Back to Orders\"}),/*#__PURE__*/_jsx(Link,{to:\"/products\",className:\"btn btn-primary\",children:\"\\uD83D\\uDED2 Order Again\"})]})]})]})]})]});};export default OrderDetails;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}