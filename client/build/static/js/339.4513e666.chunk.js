"use strict";(self.webpackChunkecommerce_client=self.webpackChunkecommerce_client||[]).push([[339],{1339:(e,s,r)=>{r.r(s),r.d(s,{default:()=>c});var i=r(9950),a=r(5184),n=r(9588),t=r(7832),l=(r(7705),r(4414));const c=()=>{const[e,s]=(0,i.useState)(!1),[r,c]=(0,i.useState)("689c822ba89dd55d26c15cb3"),d={_id:"689c822ba89dd55d26c15cb3",status:"Confirmed",totalAmount:148440,paymentMethod:"cod",deliveryPersonName:"Rajesh Gupta",deliveryPersonPhone:"+91-9876543214",deliveryPersonVehicle:"Van",deliveryPersonRating:4.4,estimatedDeliveryTime:new Date(Date.now()+864e5).toISOString(),deliveryTracking:[{_id:"1",status:"Confirmed",message:"Order confirmed and assigned to Rajesh Gupta. COD order will be delivered within 24 hours.",timestamp:(new Date).toISOString(),deliveryPerson:{name:"Rajesh Gupta",phone:"+91-9876543214",vehicle:"Van"}},{_id:"2",status:"Preparing",message:"Your order is being prepared for dispatch.",timestamp:new Date(Date.now()+72e5).toISOString(),deliveryPerson:{name:"Rajesh Gupta",phone:"+91-9876543214",vehicle:"Van"}}],items:[{name:"iPhone 15 Pro",description:"Latest iPhone 15 Pro with titanium design",quantity:1,price:134900}],customerInfo:{name:"John Doe",email:"john.doe@example.com",phone:"+91-9876543211",address:"456 Test Avenue, Delhi, Delhi 110001"},createdAt:(new Date).toISOString()};return(0,l.jsx)("div",{className:"test-page",children:(0,l.jsxs)("div",{className:"container",children:[(0,l.jsxs)("div",{className:"test-header",children:[(0,l.jsx)("h1",{children:"\ud83d\ude9a Delivery Notification System Test"}),(0,l.jsx)("p",{children:"This page demonstrates the real-time delivery notifications and order tracking system."})]}),(0,l.jsxs)("div",{className:"test-controls",children:[(0,l.jsxs)("div",{className:"control-group",children:[(0,l.jsx)("label",{htmlFor:"orderIdInput",children:"Order ID:"}),(0,l.jsx)("input",{id:"orderIdInput",type:"text",value:r,onChange:e=>c(e.target.value),placeholder:"Enter Order ID",className:"order-input"})]}),(0,l.jsxs)("div",{className:"control-buttons",children:[(0,l.jsx)("button",{onClick:()=>s(!0),className:"test-btn primary",children:"\ud83d\udcf1 Show Delivery Notifications"}),(0,l.jsx)("button",{onClick:()=>window.location.reload(),className:"test-btn secondary",children:"\ud83d\udd04 Refresh Page"})]})]}),(0,l.jsxs)("div",{className:"demo-section",children:[(0,l.jsx)("h2",{children:"\ud83d\udce6 Live Order Status"}),(0,l.jsx)("p",{children:"Enter an order ID above and see real-time delivery information below:"}),(0,l.jsx)(a.A,{orderId:r})]}),(0,l.jsxs)("div",{className:"demo-info",children:[(0,l.jsx)("h3",{children:"\u2728 Features Demonstrated:"}),(0,l.jsxs)("ul",{children:[(0,l.jsxs)("li",{children:["\ud83c\udfaf ",(0,l.jsx)("strong",{children:"Real-time Order Tracking:"})," Live status updates with progress indicators"]}),(0,l.jsxs)("li",{children:["\ud83d\udc68\u200d\ud83d\udcbc ",(0,l.jsx)("strong",{children:"Delivery Executive Details:"})," Name, phone, vehicle type, and ratings"]}),(0,l.jsxs)("li",{children:["\ud83d\udcf1 ",(0,l.jsx)("strong",{children:"Interactive Notifications:"})," Toast notifications and detailed timeline"]}),(0,l.jsxs)("li",{children:["\ud83d\udcde ",(0,l.jsx)("strong",{children:"Direct Communication:"})," One-click calling to delivery personnel"]}),(0,l.jsxs)("li",{children:["\u23f0 ",(0,l.jsx)("strong",{children:"Estimated Delivery:"})," Accurate time predictions with live updates"]}),(0,l.jsxs)("li",{children:["\ud83d\udccb ",(0,l.jsx)("strong",{children:"Complete Timeline:"})," Full tracking history with timestamps"]}),(0,l.jsxs)("li",{children:["\ud83d\udcb0 ",(0,l.jsx)("strong",{children:"COD Support:"})," Automatic delivery assignment for Cash on Delivery orders"]}),(0,l.jsxs)("li",{children:["\ud83d\udcca ",(0,l.jsx)("strong",{children:"Order Summary:"})," Complete order details with customer information"]})]})]}),(0,l.jsxs)("div",{className:"sample-data",children:[(0,l.jsx)("h3",{children:"\ud83e\uddea Test Data Available:"}),(0,l.jsx)("div",{className:"test-order-cards",children:(0,l.jsxs)("div",{className:"test-card",children:[(0,l.jsx)("h4",{children:"\ud83d\udcf1 Current Test Order"}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Order ID:"})," ",r]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Product:"})," iPhone 15 Pro"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Delivery Person:"})," Rajesh Gupta"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Status:"})," Confirmed"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Payment:"})," Cash on Delivery"]})]})})]}),e&&(0,l.jsx)(n.A,{order:d,onClose:()=>s(!1)}),(0,l.jsx)(t.N9,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})})}},5184:(e,s,r)=>{r.d(s,{A:()=>l});var i=r(9950),a=r(9588),n=r(7832),t=r(4414);const l=e=>{var s,r,l,c,d;let{orderId:o}=e;const[h,m]=(0,i.useState)(null),[v,u]=(0,i.useState)(!0),[x,j]=(0,i.useState)(!1),[p,N]=(0,i.useState)(""),[y,g]=(0,i.useState)(new Date);(0,i.useEffect)(()=>{const e=async()=>{try{const e=await fetch("http://localhost:5000/api/orders/".concat(o));if(e.ok){const s=await e.json();h&&h.status!==s.status&&n.oR.success("Order status updated to: ".concat(s.status),{position:"top-right",autoClose:4e3}),m(s)}else N("Failed to fetch order details")}catch(e){console.error("Error fetching order:",e),N("Error loading order details")}finally{u(!1)}};if(o){e();const s=setInterval(e,3e4);return()=>clearInterval(s)}},[o]),(0,i.useEffect)(()=>{const e=setInterval(()=>{g(new Date)},1e3);return()=>clearInterval(e)},[]);const f=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"pending":return"#ffc107";case"confirmed":case"delivered":return"#28a745";case"preparing":return"#fd7e14";case"out for delivery":return"#6f42c1";case"nearby":return"#dc3545";default:return"#6c757d"}},D=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),w=e=>{const s=new Date(e);return{date:s.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),time:s.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}};if(v)return(0,t.jsx)("div",{className:"order-status-container",children:(0,t.jsxs)("div",{className:"loading-spinner",children:[(0,t.jsx)("div",{className:"spinner"}),(0,t.jsx)("p",{children:"Loading order details..."})]})});if(p)return(0,t.jsx)("div",{className:"order-status-container",children:(0,t.jsxs)("div",{className:"error-message",children:[(0,t.jsx)("h3",{children:"\u274c Error"}),(0,t.jsx)("p",{children:p}),(0,t.jsx)("button",{onClick:fetchOrderDetails,className:"retry-btn",children:"\ud83d\udd04 Retry"})]})});if(!h)return(0,t.jsx)("div",{className:"order-status-container",children:(0,t.jsxs)("div",{className:"no-order",children:[(0,t.jsx)("h3",{children:"\ud83d\udce6 No Order Found"}),(0,t.jsxs)("p",{children:["Order ID: ",o]})]})});const b=w(h.createdAt);return(0,t.jsxs)("div",{className:"order-status-container",children:[(0,t.jsxs)("div",{className:"order-header",children:[(0,t.jsxs)("div",{className:"order-title",children:[(0,t.jsxs)("h2",{children:["\ud83d\udce6 Order #",h._id.slice(-8).toUpperCase()]}),(0,t.jsxs)("p",{className:"order-date",children:["Placed on ",b.date," at ",b.time]})]}),(0,t.jsxs)("div",{className:"order-amount",children:[(0,t.jsx)("h3",{children:D(h.totalAmount)}),(0,t.jsx)("span",{className:"payment-method",children:"cod"===h.paymentMethod?"\ud83d\udcb5 Cash on Delivery":"\ud83d\udcb3 Online Payment"})]})]}),(0,t.jsxs)("div",{className:"status-progress",children:[(0,t.jsxs)("div",{className:"progress-header",children:[(0,t.jsx)("h3",{children:"\ud83d\udcca Order Progress"}),(0,t.jsx)("span",{className:"current-status",style:{color:f(h.status)},children:h.status})]}),(0,t.jsx)("div",{className:"progress-bar",children:(0,t.jsx)("div",{className:"progress-fill",style:{width:"".concat((e=>{const s=["Pending","Confirmed","Preparing","Out for Delivery","Nearby","Delivered"],r=s.indexOf(e);return Math.max(0,(r+1)/s.length*100)})(h.status),"%"),backgroundColor:f(h.status)}})}),(0,t.jsxs)("div",{className:"progress-labels",children:[(0,t.jsx)("span",{children:"Confirmed"}),(0,t.jsx)("span",{children:"Preparing"}),(0,t.jsx)("span",{children:"Out for Delivery"}),(0,t.jsx)("span",{children:"Delivered"})]})]}),h.deliveryPersonName&&(0,t.jsxs)("div",{className:"delivery-info-card",children:[(0,t.jsxs)("div",{className:"card-header",children:[(0,t.jsx)("h3",{children:"\ud83d\ude9a Delivery Information"}),(0,t.jsx)("button",{onClick:()=>j(!0),className:"view-details-btn",children:"\ud83d\udcf1 View Full Timeline"})]}),(0,t.jsxs)("div",{className:"delivery-executive",children:[(0,t.jsx)("div",{className:"executive-avatar",children:h.deliveryPersonName.charAt(0).toUpperCase()}),(0,t.jsxs)("div",{className:"executive-details",children:[(0,t.jsx)("h4",{children:h.deliveryPersonName}),(0,t.jsxs)("p",{children:["\ud83d\udcde ",h.deliveryPersonPhone]}),(0,t.jsxs)("p",{children:["\ud83d\udef5 ",h.deliveryPersonVehicle]}),(0,t.jsxs)("div",{className:"rating",children:["\u2b50".repeat(Math.floor(h.deliveryPersonRating||4.5)),(0,t.jsxs)("span",{children:[h.deliveryPersonRating||4.5,"/5"]})]})]}),(0,t.jsxs)("div",{className:"executive-actions",children:[(0,t.jsx)("button",{className:"call-btn",onClick:()=>window.open("tel:".concat(h.deliveryPersonPhone)),children:"\ud83d\udcde Call"}),(0,t.jsx)("button",{className:"track-btn",children:"\ud83d\udccd Track"})]})]}),h.estimatedDeliveryTime&&(0,t.jsxs)("div",{className:"estimated-delivery",children:[(0,t.jsx)("h4",{children:"\u23f0 Estimated Delivery"}),(0,t.jsxs)("p",{className:"delivery-time",children:[w(h.estimatedDeliveryTime).date," at ",w(h.estimatedDeliveryTime).time]}),(0,t.jsxs)("p",{className:"time-remaining",children:["\ud83d\udd52 ",(e=>{const s=new Date,r=new Date(e).getTime()-s.getTime();if(r<=0)return"Delivery time reached";const i=Math.floor(r/36e5),a=Math.floor(r%36e5/6e4),n=Math.floor(r%6e4/1e3);return i>0?"".concat(i,"h ").concat(a,"m ").concat(n,"s remaining"):a>0?"".concat(a,"m ").concat(n,"s remaining"):"".concat(n,"s remaining")})(h.estimatedDeliveryTime)]})]}),h.deliveryTracking&&h.deliveryTracking.length>0&&(0,t.jsxs)("div",{className:"latest-update",children:[(0,t.jsx)("h4",{children:"\ud83d\udce2 Latest Update"}),(0,t.jsxs)("div",{className:"update-card",children:[(0,t.jsx)("div",{className:"update-status",style:{color:f(h.status)},children:h.status}),(0,t.jsx)("p",{children:h.deliveryTracking[h.deliveryTracking.length-1].message}),(0,t.jsx)("small",{children:w(h.deliveryTracking[h.deliveryTracking.length-1].timestamp).time})]})]})]}),(0,t.jsxs)("div",{className:"order-items-card",children:[(0,t.jsx)("h3",{children:"\ud83d\udecd\ufe0f Order Items"}),(0,t.jsx)("div",{className:"items-list",children:null===(s=h.items)||void 0===s?void 0:s.map((e,s)=>(0,t.jsxs)("div",{className:"item-row",children:[(0,t.jsxs)("div",{className:"item-info",children:[(0,t.jsx)("h4",{children:e.name}),(0,t.jsx)("p",{children:e.description})]}),(0,t.jsx)("div",{className:"item-quantity",children:(0,t.jsxs)("span",{children:["Qty: ",e.quantity]})}),(0,t.jsx)("div",{className:"item-price",children:(0,t.jsx)("span",{children:D(e.price*e.quantity)})})]},s))}),(0,t.jsx)("div",{className:"order-total",children:(0,t.jsxs)("div",{className:"total-row",children:[(0,t.jsx)("span",{children:"Total Amount:"}),(0,t.jsx)("span",{className:"total-amount",children:D(h.totalAmount)})]})})]}),(0,t.jsxs)("div",{className:"customer-info-card",children:[(0,t.jsx)("h3",{children:"\ud83d\udc64 Customer Information"}),(0,t.jsxs)("div",{className:"customer-details",children:[(0,t.jsxs)("div",{className:"detail-row",children:[(0,t.jsx)("span",{className:"label",children:"Name:"}),(0,t.jsx)("span",{className:"value",children:(null===(r=h.customerInfo)||void 0===r?void 0:r.name)||"N/A"})]}),(0,t.jsxs)("div",{className:"detail-row",children:[(0,t.jsx)("span",{className:"label",children:"Email:"}),(0,t.jsx)("span",{className:"value",children:(null===(l=h.customerInfo)||void 0===l?void 0:l.email)||"N/A"})]}),(0,t.jsxs)("div",{className:"detail-row",children:[(0,t.jsx)("span",{className:"label",children:"Phone:"}),(0,t.jsx)("span",{className:"value",children:(null===(c=h.customerInfo)||void 0===c?void 0:c.phone)||"N/A"})]}),(0,t.jsxs)("div",{className:"detail-row",children:[(0,t.jsx)("span",{className:"label",children:"Address:"}),(0,t.jsx)("span",{className:"value",children:(null===(d=h.customerInfo)||void 0===d?void 0:d.address)||"N/A"})]})]})]}),(0,t.jsxs)("div",{className:"order-actions",children:[(0,t.jsx)("button",{onClick:()=>j(!0),className:"action-btn primary",children:"\ud83d\udcf1 View Full Timeline"}),(0,t.jsx)("button",{onClick:async()=>{u(!0),N("");try{const e=await fetch("http://localhost:5000/api/orders/".concat(o));if(e.ok){const s=await e.json();m(s),n.oR.info("Order details refreshed!",{position:"top-right",autoClose:2e3})}else N("Failed to fetch order details")}catch(e){console.error("Error fetching order:",e),N("Error loading order details")}finally{u(!1)}},className:"action-btn secondary",children:"\ud83d\udd04 Refresh Status"}),(0,t.jsx)("button",{className:"action-btn secondary",children:"\ud83d\udcc4 Download Invoice"})]}),x&&(0,t.jsx)(a.A,{order:h,onClose:()=>j(!1)})]})}},7705:()=>{},9588:(e,s,r)=>{r.d(s,{A:()=>t});var i=r(9950),a=r(7832),n=r(4414);const t=e=>{let{order:s,onClose:r}=e;const[t,l]=(0,i.useState)(""),[c,d]=(0,i.useState)([]),[o,h]=(0,i.useState)(new Date);(0,i.useEffect)(()=>{if(s&&s.deliveryTracking){d(s.deliveryTracking),l(s.status);const e=s.deliveryTracking[s.deliveryTracking.length-1];e&&a.oR.info("\ud83d\udce6 ".concat(e.message),{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0})}},[s]),(0,i.useEffect)(()=>{const e=setInterval(()=>{h(new Date)},1e3);return()=>clearInterval(e)},[]);const m=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"assigned":return"\ud83d\udc68\u200d\ud83d\udcbc";case"confirmed":return"\u2705";case"preparing":return"\ud83d\udc68\u200d\ud83c\udf73";case"out for delivery":return"\ud83d\ude97";case"nearby":return"\ud83d\udccd";case"delivered":return"\ud83c\udf89";default:return"\ud83d\udce6"}},v=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"assigned":return"#17a2b8";case"confirmed":case"delivered":return"#28a745";case"preparing":return"#fd7e14";case"out for delivery":return"#6f42c1";case"nearby":return"#dc3545";default:return"#6c757d"}},u=e=>new Date(e).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0});return s&&c.length?(0,n.jsx)("div",{className:"delivery-notifications-overlay",children:(0,n.jsxs)("div",{className:"delivery-notifications-modal",children:[(0,n.jsxs)("div",{className:"delivery-header",children:[(0,n.jsx)("h3",{children:"\ud83d\ude9a Delivery Updates"}),(0,n.jsx)("button",{className:"close-btn",onClick:r,children:"\xd7"})]}),(0,n.jsx)("div",{className:"current-status",children:(0,n.jsxs)("div",{className:"status-badge",style:{backgroundColor:v(t)},children:[m(t)," ",t]})}),s.deliveryPersonName&&(0,n.jsxs)("div",{className:"delivery-executive-info",children:[(0,n.jsx)("h4",{children:"\ud83d\udc68\u200d\ud83d\udcbc Delivery Executive"}),(0,n.jsx)("div",{className:"executive-details",children:(0,n.jsxs)("div",{className:"executive-card",children:[(0,n.jsx)("div",{className:"executive-avatar",children:s.deliveryPersonName.charAt(0).toUpperCase()}),(0,n.jsxs)("div",{className:"executive-info",children:[(0,n.jsx)("h5",{children:s.deliveryPersonName}),(0,n.jsxs)("p",{children:["\ud83d\udcde ",s.deliveryPersonPhone]}),(0,n.jsxs)("p",{children:["\ud83d\udef5 ",s.deliveryPersonVehicle]}),(0,n.jsxs)("div",{className:"rating",children:["\u2b50".repeat(Math.floor(s.deliveryPersonRating||4.5)),(0,n.jsxs)("span",{children:[s.deliveryPersonRating||4.5,"/5"]})]})]}),(0,n.jsx)("div",{className:"executive-actions",children:(0,n.jsx)("button",{className:"call-btn",onClick:()=>window.open("tel:".concat(s.deliveryPersonPhone)),children:"\ud83d\udcde Call"})})]})})]}),s.estimatedDeliveryTime&&(0,n.jsxs)("div",{className:"estimated-delivery",children:[(0,n.jsx)("h4",{children:"\u23f0 Estimated Delivery"}),(0,n.jsxs)("p",{className:"delivery-time",children:[(x=s.estimatedDeliveryTime,new Date(x).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}))," at ",u(s.estimatedDeliveryTime)]}),(0,n.jsxs)("p",{className:"time-remaining",children:["\ud83d\udd52 ",(e=>{const s=new Date,r=new Date(e).getTime()-s.getTime();if(r<=0)return"Delivery time reached";const i=Math.floor(r/36e5),a=Math.floor(r%36e5/6e4),n=Math.floor(r%6e4/1e3);return i>0?"".concat(i,"h ").concat(a,"m ").concat(n,"s remaining"):a>0?"".concat(a,"m ").concat(n,"s remaining"):"".concat(n,"s remaining")})(s.estimatedDeliveryTime)]})]}),(0,n.jsxs)("div",{className:"tracking-timeline",children:[(0,n.jsx)("h4",{children:"\ud83d\udccb Order Timeline"}),(0,n.jsx)("div",{className:"timeline",children:c.map((e,s)=>(0,n.jsxs)("div",{className:"timeline-item",children:[(0,n.jsx)("div",{className:"timeline-marker",style:{backgroundColor:v(e.status)},children:m(e.status)}),(0,n.jsxs)("div",{className:"timeline-content",children:[(0,n.jsxs)("div",{className:"timeline-header",children:[(0,n.jsx)("h5",{children:e.status}),(0,n.jsx)("span",{className:"timeline-time",children:u(e.timestamp)})]}),(0,n.jsx)("p",{children:e.message}),e.deliveryPerson&&(0,n.jsx)("div",{className:"timeline-person",children:(0,n.jsxs)("small",{children:[e.deliveryPerson.name," \u2022 ",e.deliveryPerson.phone," \u2022 ",e.deliveryPerson.vehicle]})})]})]},e._id||s))})]}),(0,n.jsxs)("div",{className:"order-actions",children:[(0,n.jsx)("button",{className:"action-btn primary",children:"\ud83d\udccd Track Live Location"}),(0,n.jsx)("button",{className:"action-btn secondary",children:"\ud83d\udcac Chat with Delivery Partner"})]})]})}):null;var x}}}]);